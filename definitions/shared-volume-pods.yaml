{
    "version": "kubepattern.sigemi.it/v1",
    "kind": "Pattern",
    "metadata": {
        "name": "shared-volume-pod",
        "displayName": "Shared Volume Pod",
        "patternType": "Custom",
        "severity": "Warning",
        "category": "test",
        "docUrl": "https://github.com/GabrieleGroppo/kubepattern-registry/tree/main/definitions",
        "gitUrl": "https://github.com/GabrieleGroppo/kubepattern-registry/tree/main/doc",
        "patternURI": "patternURI"
    },
    "spec": {
        "description": "Identifica pattern sidecar dove un pod principale condivide volumi con un container di supporto per logging o monitoring",
        "message": "Il pod {{main-app.name}} nel namespace {{main-app.namespace}} potrebbe implementare un pattern sidecar con {{sidecar.name}}",
        "resources": [
            {
                "resource": "Pod",
                "id": "main-app",
                "filters": {
                    "matchAll": [],
                    "matchNone": [
                        {
                            "key": ".metadata.namespace",
                            "operator": "EQUALS",
                            "values": [
                                "kube-system",
                                "kube-public",
                                "kube-node-lease"
                            ]
                        }
                    ],
                    "matchAny": []
                }
            },
            {
                "resource": "Pod",
                "id": "sidecar",
                "filters": {
                    "matchAll": [],
                    "matchNone": [
                        {
                            "key": ".metadata.namespace",
                            "operator": "EQUALS",
                            "values": [
                                "kube-system",
                                "kube-public",
                                "kube-node-lease"
                            ]
                        }
                    ],
                    "matchAny": []
                }
            }
        ],
        "relationships": [
            {
                "id": "main-app-sidecar-network-proximity",
                "type": "NetworkProximity",
                "description": "Resources should be network-accessible to each other",
                "weight": 0.5,
                "required": true,
                "shared": false,
                "resourceIds": [
                    "main-app",
                    "sidecar"
                ],

            },
            {
                "id": "main-app-sidecar-shared-volume",
                "type": "SharedVolume",
                "weight": 1.0,
                "description": "Resources should share volumes for data exchange",
                "required": false,
                "shared": true,
                "resourceIds": [
                    "main-app",
                    "sidecar"
                ],
            }
        ]
    }
}