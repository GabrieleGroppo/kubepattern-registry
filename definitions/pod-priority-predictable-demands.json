{
    "version": "kubepattern.it/v1",
    "kind": "Pattern",
    "metadata": {
        "name": "pod-priority-predictable-demands",
        "displayName": "Pod Priority Predictable Demands",
        "patternType": "FOUNDATIONAL",
        "severity": "WARNING",
        "category": "architecture",
        "docUrl": "https://kubernetes.io/docs/concepts/workloads/pods/pod-priority-predictable-demands/",
        "gitUrl": "https://github.com/GabrieleGroppo/kubepattern-registry/tree/main/doc/pod-priority-pattern.md",
        "patternURI": "kubepattern://foundational/pod-priority-predictable-demands"
    },
    "spec": {
        "description": "Identifies pods that lack of explicit priority settings. Setting priority for such pods is crucial to prevent resource contention, ensure fair resource allocation, and maintain cluster stability. This pattern helps in identifying pods that could benefit from defined priority to enhance overall cluster performance and reliability.",
        "message": "Pod {{single-pod.name}} in namespace {{single-pod.namespace}} does not have a priority class defined. It is recommended to set an appropriate priority class to ensure stable performance within the cluster.",
        "topology": "SINGLE",
        "leader": "single-pod",
        "resources": [
            {
                "resource": "Pod",
                "id": "single-pod",
                "filters": {
                    "matchAll": null,
                    "matchNone": [
                        {
                            "key": ".metadata.namespace",
                            "operator": "EQUALS",
                            "values": [
                                "kube-system",
                                "kube-public",
                                "kube-node-lease",
                                "krateo-system"
                            ]
                        }
                    ],
                    "matchAny": [
                        {
                            "key": ".spec.priorityClassName",
                            "operator": "IS_EMPTY",
                            "values": []
                        },
                        {
                            "key": ".spec.priority",
                            "operator": "IS_EMPTY",
                            "values": []
                        },
                        {
                            "key": ".spec.priority",
                            "operator": "EQUALS",
                            "values": [
                                "0"
                            ]
                        }
                    ]
                }
            }
        ],
        "relationships": []
    }
}