{
    "version": "kubepattern.it/v1",
    "kind": "Pattern",
    "metadata": {
        "name": "find-timeouts-exec",
        "displayName": "Timeout Exec",
        "patternType": "CUSTOM",
        "severity": "INFO",
        "category": "update",
        "gitUrl": "https://github.com/kubepattern/registry/tree/main/doc/k8s-missing-tier.json",
        "docUrl": "https://docs.cloud.google.com/kubernetes-engine/docs/deprecations/exec-probe-timeouts",
        "description": "Find Timeout Exec field in cluster critical for Kubernetes GKE update"
    },
    "spec": {
        "message": "Pod '{{app.name}}' in namespace '{{app.namespace}}' has exec probe.",
        "topology": "SINGLE",
        "resources": [
            {
                "resource": "Pod",
                "id": "app",
                "leader": true,
                "filters": {
                    "matchAny": [
                        {
                            "key": ".spec.containers[*].livenessProbe.exec",
                            "operator": "EXISTS",
                            "values": []
                        },
                        {
                            "key": ".spec.containers[*].redinessProbe.exec",
                            "operator": "EXISTS",
                            "values": []
                        },
                        {
                            "key": ".spec.containers[*].startupProbe.exec",
                            "operator": "EXISTS",
                            "values": []
                        }
                    ],
                    "matchNone": [
                        {
                            "key": ".metadata.namespace",
                            "operator": "EQUALS",
                            "values": [
                                "kube-system",
                                "kube-public",
                                "kube-node-lease",
                                "krateo-system"
                            ]
                        }
                    ]
                }
            }
        ],
        "actors": [
            "app"
        ]
    }
}
